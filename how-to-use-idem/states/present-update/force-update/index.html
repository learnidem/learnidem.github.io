<!doctype html><html lang=en-gb>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Force Update - Learn Idem</title><meta name=description content="Powered by Idem Project">
<meta name=generator content="Hugo 0.93.3">
<link href=https://learnidem.github.io/index.xml rel=alternate type=application/rss+xml>
<link rel=canonical href=https://learnidem.github.io/how-to-use-idem/states/present-update/force-update/>
<link rel=stylesheet href=https://learnidem.github.io/css/theme.css>
<link rel=stylesheet href=/css/lightbox.min.css>
<link rel=stylesheet href=/css/custom.css>
<script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script>
<link rel=stylesheet href=https://learnidem.github.io/css/chroma.min.css>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script>
<script src=https://learnidem.github.io/js/bundle.js></script>
<script src=/js/lightbox.min.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8R0DEW1VZM"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8R0DEW1VZM")</script>
<style>:root{--custom-font-color:#238FCF;--custom-background-color:#FFFFFF}</style><meta property="og:title" content="Force Update">
<meta property="og:description" content="Powered by Idem Project">
<meta property="og:type" content="website">
<meta property="og:url" content="https://learnidem.github.io/how-to-use-idem/states/present-update/force-update/"><meta property="og:image" content="https://learnidem.github.io/images/1254756-oss-id-idem-project.png"><meta property="og:site_name" content="Learn Idem">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://learnidem.github.io/images/1254756-oss-id-idem-project.png">
<meta name=twitter:title content="Force Update">
<meta name=twitter:description content="Powered by Idem Project">
<meta itemprop=name content="Force Update">
<meta itemprop=description content="Powered by Idem Project"></head><body><div class=container><header>
<div class=header-image>
<img src=/images/1254756-oss-id-idem-project.png alt="   Learn Idem">
</div><div class=header>
<div class=header-h1>
<h1 class=header-h1> Learn Idem</h1></div><div class=header-description>
<p class=description>Powered by Idem Project</p></div></div></header><div class=content-container>
<main><h1>Force Update</h1><p><b style=color:#000>Use
with caution;</b> <b style=color:red>&ldquo;PUT&rdquo; operation can wipe out some existing data or replace the whole resource</b>, e.g. it could destroy and recreate a Virtual Machine.</p><p>Let&rsquo;s say I have already the Azure Virtual Network : vNet1-Idem</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>(</span>my_idem_env<span class=o>)</span> demouser@idem:~/environments$ idem describe azure.virtual_networks.virtual_networks  --filter<span class=o>=</span><span class=s2>&#34;[?resource[?virtual_network_name==&#39;vNet1-Idem&#39;]]&#34;</span> 
</span></span><span class=line><span class=cl>? /subscriptions/23a8cee7-a1e4-4bb3-aff9-6898b4ee6fde/resourceGroups/Moff-RG01-CAS/providers/Microsoft.Network/virtualNetworks/vNet1-Idem
</span></span><span class=line><span class=cl>: azure.virtual_networks.virtual_networks.present:
</span></span><span class=line><span class=cl>  - resource_group_name: Moff-RG01-CAS
</span></span><span class=line><span class=cl>  - virtual_network_name: vNet1-Idem
</span></span><span class=line><span class=cl>  - parameters:
</span></span><span class=line><span class=cl>      etag: W/<span class=s2>&#34;4b58c957-49a6-49d5-b607-258bf9275080&#34;</span>
</span></span><span class=line><span class=cl>      id: /subscriptions/23a8cee7-a1e4-4bb3-aff9-6898b4ee6fde/resourceGroups/Moff-RG01-CAS/providers/Microsoft.Network/virtualNetworks/vNet1-Idem
</span></span><span class=line><span class=cl>      location: centralus
</span></span><span class=line><span class=cl>      name: vNet1-Idem
</span></span><span class=line><span class=cl>      properties:
</span></span><span class=line><span class=cl>        addressSpace:
</span></span><span class=line><span class=cl>          addressPrefixes:
</span></span><span class=line><span class=cl>          - 10.0.0.0/24
</span></span><span class=line><span class=cl>        enableDdosProtection: <span class=nb>false</span>
</span></span><span class=line><span class=cl>        provisioningState: Succeeded
</span></span><span class=line><span class=cl>        resourceGuid: 5416c5e5-72e8-4f02-9276-8b028d045a4f
</span></span><span class=line><span class=cl>        subnets: <span class=o>[]</span>
</span></span><span class=line><span class=cl>        virtualNetworkPeerings: <span class=o>[]</span>
</span></span><span class=line><span class=cl>      type: Microsoft.Network/virtualNetworks
</span></span></code></pre></div><p>and we need to update the Address Prefix from 10.0.0.0/24 to 10.12.13.0/25, we could do it by updating an SLS file and executing <a href=/How-to-use-Idem/Use-Cases/>
idem state
</a>, however due to the nature of the virtual network resource, it needs to be recreated, so we could only do it by running the same SLS file but this time explicitly including the <b>force_update</b> set to &ldquo;True&rdquo;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>vNet1-Idem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>azure.virtual_networks.virtual_networks.present</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>force_update</span><span class=p>:</span><span class=w> </span><span class=kc>True</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>resource_group_name</span><span class=p>:</span><span class=w> </span><span class=l>Moff-RG01-CAS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>virtual_network_name</span><span class=p>:</span><span class=w> </span><span class=l>vNet1-Idem</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>parameters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>location</span><span class=p>:</span><span class=w> </span><span class=l>centralus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>vNet1-Idem</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>addressSpace</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>addressPrefixes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=m>10.12.13.0</span><span class=l>/25</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enableDdosProtection</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span></code></pre></div><p>We apply our changes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>idem state update_virtual_network_addPrefix.sls
</span></span></code></pre></div><p>Then we verify that the Address Prefix was indeed updated</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>(</span>my_idem_env<span class=o>)</span> demouser@idem:~/environments$ idem describe azure.virtual_networks.virtual_networks  --filter<span class=o>=</span><span class=s2>&#34;[?resource[?virtual_network_name==&#39;vNet1-Idem&#39;]]&#34;</span> 
</span></span><span class=line><span class=cl>? /subscriptions/23a8cee7-a1e4-4bb3-aff9-6898b4ee6fde/resourceGroups/Moff-RG01-CAS/providers/Microsoft.Network/virtualNetworks/vNet1-Idem
</span></span><span class=line><span class=cl>: azure.virtual_networks.virtual_networks.present:
</span></span><span class=line><span class=cl>  - resource_group_name: Moff-RG01-CAS
</span></span><span class=line><span class=cl>  - virtual_network_name: vNet1-Idem
</span></span><span class=line><span class=cl>  - parameters:
</span></span><span class=line><span class=cl>      etag: W/<span class=s2>&#34;f36439b9-78db-48b1-96aa-92a4a950397d&#34;</span>
</span></span><span class=line><span class=cl>      id: /subscriptions/23a8cee7-a1e4-4bb3-aff9-6898b4ee6fde/resourceGroups/Moff-RG01-CAS/providers/Microsoft.Network/virtualNetworks/vNet1-Idem
</span></span><span class=line><span class=cl>      location: centralus
</span></span><span class=line><span class=cl>      name: vNet1-Idem
</span></span><span class=line><span class=cl>      properties:
</span></span><span class=line><span class=cl>        addressSpace:
</span></span><span class=line><span class=cl>          addressPrefixes:
</span></span><span class=line><span class=cl>          - 10.12.13.0/25
</span></span><span class=line><span class=cl>        enableDdosProtection: <span class=nb>false</span>
</span></span><span class=line><span class=cl>        provisioningState: Succeeded
</span></span><span class=line><span class=cl>        resourceGuid: 636fd30a-b0d8-471d-9868-c684ad602597
</span></span><span class=line><span class=cl>        subnets: <span class=o>[]</span>
</span></span><span class=line><span class=cl>        virtualNetworkPeerings: <span class=o>[]</span>
</span></span><span class=line><span class=cl>      type: Microsoft.Network/virtualNetworks
</span></span></code></pre></div><script id=asciicast-2Ae7Ar7RECBy8Io3124LEh3Wk src=https://asciinema.org/a/2Ae7Ar7RECBy8Io3124LEh3Wk.js async theme=asciinema data-autoplay=true data-size=small loop=true></script>
<div class=edit-meta>
Last updated on 28 Feb 2022
<br><a href=https://github.com/cmbu-tmm-sites/learnidem/edit/main/content/How%20to%20use%20Idem/States/Present%20Update/Force%20Update/_index.md class=edit-page><i class="fas fa-pen-square"></i>&nbsp;Edit on GitHub</a></div><nav class=pagination><a class="nav nav-prev" href=https://learnidem.github.io/how-to-use-idem/states/present-update/ title="Present Update"><i class="fas fa-arrow-left" aria-hidden=true></i>&nbsp;Prev - Present Update</a>
<a class="nav nav-next" href=https://learnidem.github.io/how-to-use-idem/states/absent/ title=Absent>Next - Absent <i class="fas fa-arrow-right" aria-hidden=true></i></a>
</nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme adapted from <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar>
<nav class=slide-menu>
<ul>
<li><a href=https://learnidem.github.io>Home</a></li><li class=has-sub-menu><a href=https://learnidem.github.io/getting-started/>Getting Started<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://learnidem.github.io/getting-started/install-idem/>Install Idem</a>
</li><li class=has-sub-menu><a href=https://learnidem.github.io/getting-started/cloud-plug-ins/>Cloud Plug-Ins<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://learnidem.github.io/getting-started/cloud-plug-ins/idem-azure-plug-in/>Idem Azure Plug-In</a>
</li><li><a href=https://learnidem.github.io/getting-started/cloud-plug-ins/idem-aws-plug-in/>Idem AWS Plug-In</a>
</li></ul></li><li><a href=https://learnidem.github.io/getting-started/authenticate/>Authenticate</a>
</li><li><a href=https://learnidem.github.io/getting-started/basic-commands/>Basic Commands</a>
</li><li><a href=https://learnidem.github.io/getting-started/troubleshooting/>Troubleshooting</a>
</li></ul></li><li class="parent has-sub-menu"><a href=https://learnidem.github.io/how-to-use-idem/>How to use Idem<span class="mark opened">-</span></a>
<ul class=sub-menu>
<li><a href=https://learnidem.github.io/how-to-use-idem/describe/>Describe command</a>
</li><li><a href=https://learnidem.github.io/how-to-use-idem/filter-flag/>Filter Flag</a>
</li><li class="parent has-sub-menu"><a href=https://learnidem.github.io/how-to-use-idem/states/>States<span class="mark opened">-</span></a>
<ul class=sub-menu>
<li><a href=https://learnidem.github.io/how-to-use-idem/states/present/>Present</a>
</li><li class="parent has-sub-menu"><a href=https://learnidem.github.io/how-to-use-idem/states/present-update/>Present Update<span class="mark opened">-</span></a>
<ul class=sub-menu>
<li class="parent active"><a href=https://learnidem.github.io/how-to-use-idem/states/present-update/force-update/>Force Update</a>
</li></ul></li><li><a href=https://learnidem.github.io/how-to-use-idem/states/absent/>Absent</a>
</li><li><a href=https://learnidem.github.io/how-to-use-idem/states/test-flag/>Test Flag</a>
</li><li><a href=https://learnidem.github.io/how-to-use-idem/states/describe-2-state/>Describe 2 State</a>
</li><li><a href=https://learnidem.github.io/how-to-use-idem/states/reconciler-flag/>Reconcilier Flag</a>
</li><li><a href=https://learnidem.github.io/how-to-use-idem/states/jinja-templates/>Jinja Templates</a>
</li></ul></li><li class=has-sub-menu><a href=https://learnidem.github.io/how-to-use-idem/use-cases/>Use Cases<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://learnidem.github.io/how-to-use-idem/use-cases/resources-and-sls/>Resources and SLS</a>
</li><li><a href=https://learnidem.github.io/how-to-use-idem/use-cases/end-to-end-azure-vm/>End to End Azure VM</a>
</li></ul></li></ul></li><li><a href=https://learnidem.github.io/documentation-resources/>Documentation Resources</a>
</li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20>
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div></body></html>