<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Authenticate - Learn Idem</title><meta name=description content="Powered by Idem Project"><meta name=generator content="Hugo 0.102.3"><link href=https://learnidem.github.io/index.xml rel=alternate type=application/rss+xml><link rel=canonical href=https://learnidem.github.io/getting-started/authenticate/><link rel=stylesheet href=https://learnidem.github.io/css/theme.css><link rel=stylesheet href=/css/lightbox.min.css><link rel=stylesheet href=/css/custom.css><script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script>
<link rel=stylesheet href=https://learnidem.github.io/css/chroma.min.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script>
<script src=https://learnidem.github.io/js/bundle.js></script>
<script src=/js/lightbox.min.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8R0DEW1VZM"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8R0DEW1VZM")</script><style>:root{--custom-font-color:#238FCF;--custom-background-color:#FFFFFF}</style><meta property="og:title" content="Authenticate"><meta property="og:description" content="Powered by Idem Project"><meta property="og:type" content="website"><meta property="og:url" content="https://learnidem.github.io/getting-started/authenticate/"><meta property="og:image" content="https://learnidem.github.io/images/1254756-oss-id-idem-project.png"><meta property="og:site_name" content="Learn Idem"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://learnidem.github.io/images/1254756-oss-id-idem-project.png"><meta name=twitter:title content="Authenticate"><meta name=twitter:description content="Powered by Idem Project"><meta itemprop=name content="Authenticate"><meta itemprop=description content="Powered by Idem Project"></head><body><div class=container><header><div class=header-image><img src=/images/1254756-oss-id-idem-project.png alt="   Learn Idem"></div><div class=header><div class=header-h1><h1 class=header-h1>Learn Idem</h1></div><div class=header-description><p class=description>Powered by Idem Project</p></div></div></header><div class=content-container><main><h1>Authenticate</h1><h2 id=managing-credentials>Managing Credentials</h2><p>To perform the idem operations, we would require credentials of the environment almost always.
Idem suggests the following steps for passing credentials:</p><div class=gdoc-tabs><input type=radio class="gdoc-tabs__control hidden" name=tabs-install id=tabs-install-0 checked>
<label for=tabs-install-0 class=gdoc-tabs__label>idem-azure-auto</label><div class="gdoc-markdown--nested gdoc-tabs__content"><p>Create a <code>credentials.yaml</code> file - the <code>default</code> profile will be used unless specified in the command or state file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>azure</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>client_id</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Client ID&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>secret</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Secret key&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>subscription_id</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Subcription Key ID&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tenant</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Tenant Key ID&gt;&#34;</span><span class=w>
</span></span></span></code></pre></div></div></div><p>Encrypt the credentials file using the idem encrypt command, this creates a fernet file and outputs an encryption key:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>idem encrypt /path/to/credentials.yaml
</span></span></code></pre></div><p>Please note that the output string from the command above is the key Idem uses for accessing the encrypted credentials fernet file, and that if you update your credentials file, Idem will re-use the existing <b>ACCT_KEY</b> previously generated and defined in your OS.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&lt;output encryption key&gt;
</span></span></code></pre></div><p>Example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>DvBsYojgU5gy51CecvhhC7Ywrsq9NL3CSg_XcLMKKn4</span><span class=o>=</span>
</span></span></code></pre></div><p>Before start using Idem, you need to make sure your session includes the <b>ACCT_KEY</b> & <b>ACCT_FILE</b> OS environment varialbles, otherwise export the encryption key and path to the fernet file as an OS environment variable for your session:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCT_KEY</span><span class=o>=</span>&lt;output encryption key&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCT_FILE</span><span class=o>=</span>/path/to/credentials.yaml.fernet
</span></span></code></pre></div><p>Example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCT_KEY</span><span class=o>=</span><span class=nv>DvBsYojgU5gy51CecvhhC7Ywrsq9NL3CSg_XcLMKKn4</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCT_FILE</span><span class=o>=</span>/home/demouser/environments/credentials.yaml.fernet
</span></span></code></pre></div><p>Idem securely retrieves the credentials combining those OS environment variables before executing states.<br>You can also pass those values as parameters of the <a href=Getting-Started/Basic-Commands/>Idem cli</a> <code>--acct-key</code> and <code>--acct-file</code> options while applying the states.</p><p>Example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>idem describe azure.virtual_networks.network_interfaces --acct-key <span class=nv>DvBsYojgU5gy51CecvhhC7Ywrsq9NL3CSg_XcLMKKn4</span><span class=o>=</span> --acct-file /home/demouser/environments/credentials.yaml.fernet
</span></span></code></pre></div><h2 id=credentials-and-profiles>Credentials and Profiles</h2><p>Credentials can be grouped by Plug-Ins (azure, aws, etc ) and Profiles (within each Plug-Ins section),<br>you can define multiple Plug-Ins and Profiles in a single configuration file (e.g. default, dev, staging, etc).<br>It is recommended to always include/define the &ldquo;default&rdquo; profile.<br></p><p>E.g. credentials.yaml file with multiple account profiles.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>azure</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>client_id</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Client ID&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>secret</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Secret key&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>subscription_id</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Subcription Key ID&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tenant</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Tenant Key ID&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>tmm</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>client_id</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Client ID&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>secret</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Secret key&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>subscription_id</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Subcription Key ID&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tenant</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&lt;Your Tenant Key ID&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>aws</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>aws_access_key_id</span><span class=p>:</span><span class=w> </span><span class=l>&lt;Your Access Key ID&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>aws_secret_access_key</span><span class=p>:</span><span class=w> </span><span class=l>&lt;Your Secret Access Key&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>region_name</span><span class=p>:</span><span class=w> </span><span class=l>&lt;AWS Region&gt;</span><span class=w>
</span></span></span></code></pre></div><p>With Idem, You use the account profile flag <code>--acct-profile</code> to indicate which specific profile and associated set of credentials to be used. Please note that if you don&rsquo;t specific the account profile flag <code>--acct-profile</code>, the default profile is going to be always used (if profile default is defined at the configuration yaml)<br></p><p>The following command will instruct <a href=/Getting-Started/Install-Idem/>Idem</a> to use the Azure credentials associated to the &ldquo;default&rdquo; profile</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>idem describe azure.compute.virtual_machines 
</span></span></code></pre></div><p>The following command will instruct <a href=/Getting-Started/Install-Idem/>Idem</a> to use the Azure credentials associated to the &ldquo;tmm&rdquo; profile ( per credentials.yaml file from lines above)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>idem describe azure.compute.virtual_machines --acct-profile tmm
</span></span></code></pre></div><p><a href=/How-to-use-Idem/Describe/>Describe</a> Azure VM Machines within the &ldquo;tmm&rdquo; profile example:</p><script id=asciicast-SiXcq1OmVkca57LNf2m6N4wWK src=https://asciinema.org/a/SiXcq1OmVkca57LNf2m6N4wWK.js async theme=asciinema data-autoplay=true data-size=small loop=true></script><div class=edit-meta>Last updated on 16 May 2022<br><a href=https://github.com/cmbu-tmm-sites/learnidem/edit/main/content/Getting%20Started/Authenticate/_index.md class=edit-page><i class="fas fa-pen-square"></i>&nbsp;Edit on GitHub</a></div><nav class=pagination><a class="nav nav-prev" href=https://learnidem.github.io/getting-started/cloud-plug-ins/idem-aws-plug-in/ title="Idem AWS Plug-In"><i class="fas fa-arrow-left" aria-hidden=true></i>&nbsp;Prev - Idem AWS Plug-In</a>
<a class="nav nav-next" href=https://learnidem.github.io/getting-started/basic-commands/ title="Basic Commands">Next - Basic Commands <i class="fas fa-arrow-right" aria-hidden=true></i></a></nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme adapted from <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar><nav class=slide-menu><ul><li><a href=https://learnidem.github.io>Home</a></li><li class="parent has-sub-menu"><a href=https://learnidem.github.io/getting-started/>Getting Started<span class="mark opened">-</span></a><ul class=sub-menu><li><a href=https://learnidem.github.io/getting-started/install-idem/>Install Idem</a></li><li class=has-sub-menu><a href=https://learnidem.github.io/getting-started/cloud-plug-ins/>Cloud Plug-Ins<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://learnidem.github.io/getting-started/cloud-plug-ins/idem-azure-plug-in/>Idem Azure Plug-In</a></li><li><a href=https://learnidem.github.io/getting-started/cloud-plug-ins/idem-aws-plug-in/>Idem AWS Plug-In</a></li></ul></li><li class=active><a href=https://learnidem.github.io/getting-started/authenticate/>Authenticate</a></li><li><a href=https://learnidem.github.io/getting-started/basic-commands/>Basic Commands</a></li><li><a href=https://learnidem.github.io/getting-started/troubleshooting/>Troubleshooting</a></li></ul></li><li class=has-sub-menu><a href=https://learnidem.github.io/how-to-use-idem/>How to use Idem<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://learnidem.github.io/how-to-use-idem/describe/>Describe command</a></li><li><a href=https://learnidem.github.io/how-to-use-idem/filter-flag/>Filter Flag</a></li><li class=has-sub-menu><a href=https://learnidem.github.io/how-to-use-idem/states/>States<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://learnidem.github.io/how-to-use-idem/states/present/>Present</a></li><li class=has-sub-menu><a href=https://learnidem.github.io/how-to-use-idem/states/present-update/>Present Update<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://learnidem.github.io/how-to-use-idem/states/present-update/force-update/>Force Update</a></li></ul></li><li><a href=https://learnidem.github.io/how-to-use-idem/states/absent/>Absent</a></li><li><a href=https://learnidem.github.io/how-to-use-idem/states/test-flag/>Test Flag</a></li><li><a href=https://learnidem.github.io/how-to-use-idem/states/describe-2-state/>Describe 2 State</a></li><li><a href=https://learnidem.github.io/how-to-use-idem/states/reconciler-flag/>Reconcilier Flag</a></li><li><a href=https://learnidem.github.io/how-to-use-idem/states/jinja-templates/>Jinja Templates</a></li><li><a href=https://learnidem.github.io/how-to-use-idem/states/sleep-and-data_write/>Sleep and Data.Write</a></li></ul></li><li class=has-sub-menu><a href=https://learnidem.github.io/how-to-use-idem/use-cases/>Use Cases<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://learnidem.github.io/how-to-use-idem/use-cases/resources-and-sls/>Resources and SLS</a></li><li><a href=https://learnidem.github.io/how-to-use-idem/use-cases/end-to-end-azure-vm/>End to End Azure VM</a></li><li><a href=https://learnidem.github.io/how-to-use-idem/use-cases/aws-instance-vpc-and-subnet/>AWS Instance VPC and Subnet Resources</a></li></ul></li></ul></li><li><a href=https://learnidem.github.io/documentation-resources/>Documentation Resources</a></li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20><span class="fa-layers fa-fw"><i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i></span></a></div></body></html>